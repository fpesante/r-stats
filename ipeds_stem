library(dplyr)
library(readxl)
Query_STEM_2020 <- read_excel("C:\\Users\\francisco.pesante\\OneDrive - Instituto de Estadisticas de Puerto Rico\\Documents\\2024\\01-programas\\03-preguntas\\Query-STEM-2020.xlsx")

stem_2020a <-c("01.0308","01.0901","01.0902","01.0903","01.0904","01.0905","01.0906","01.0907","01.0999","01.1001","01.1002","01.1099","01.1101","01.1102","01.1103","01.1104","01.1105","01.1106","01.1199","01.1201","01.1202","01.1203","01.1299","01.8105","01.8106","01.8107","01.8108","01.8109","01.8110","01.8111","03.0101","03.0103","03.0104","03.0199","03.0204","03.0205","03.0210","03.0501","03.0502","03.0508","03.0509","03.0510","03.0601","04.0601","04.0902","09.0702","10.0304","11.0101","11.0102","11.0103","11.0104","11.0105","11.0199","11.0201","11.0202","11.0203","11.0299","11.0301","11.0401","11.0501","11.0701","11.0801","11.0802","11.0803","11.0804","11.0899","11.0901","11.0902","11.1001","11.1002","11.1003","11.1004","11.1005","11.1006","11.1099","13.0501","13.0601","13.0603","13.0608","14.0000","14.0100","14.0101","14.0102","14.0103","14.0200","14.0201","14.0202","14.0299","14.0300","14.0301","14.0400","14.0401","14.0500","14.0501","14.0600","14.0601","14.0700","14.0701","14.0702","14.0799","14.0800","14.0801","14.0802","14.0803","14.0804","14.0805","14.0899","14.0900","14.0901","14.0902","14.0903","14.0999","14.1000","14.1001","14.1003","14.1004","14.1099","14.1100","14.1101","14.1200","14.1201","14.1300","14.1301","14.1400","14.1401","14.1800","14.1801","14.1900","14.1901","14.2000","14.2001","14.2100","14.2101","14.2200","14.2201","14.2300","14.2301","14.2400","14.2401","14.2500","14.2501","14.2700","14.2701","14.2800","14.2801","14.3200","14.3201","14.3300","14.3301","14.3400","14.3401","14.3500","14.3501","14.3600","14.3601","14.3700","14.3701","14.3800","14.3801","14.3900","14.3901","14.4000","14.4001","14.4100","14.4101","14.4200","14.4201","14.4300","14.4301","14.4400","14.4401","14.4500","14.4501","14.4700","14.4701","14.4800","14.4801","14.4802","14.4899","14.9900","14.9999")
stem_2020b <-c("15.0000","15.0101","15.0201","15.0303","15.0304","15.0305","15.0306","15.0399","15.0401","15.0403","15.0404","15.0405","15.0406","15.0407","15.0499","15.0501","15.0506","15.0507","15.0508","15.0599","15.0607","15.0611","15.0612","15.0613","15.0614","15.0615","15.0616","15.0617","15.0699","15.0701","15.0702","15.0703","15.0704","15.0799","15.0801","15.0803","15.0805","15.0899","15.0901","15.0903","15.0999","15.1001","15.1102","15.1103","15.1199","15.1201","15.1202","15.1203","15.1204","15.1299","15.1301","15.1302","15.1303","15.1304","15.1305","15.1306","15.1399","15.1401","15.1501","15.1502","15.1503","15.1599","15.1601","15.1701","15.1703","15.9999","26.0000","26.0100","26.0101","26.0102","26.0200","26.0202","26.0203","26.0204","26.0205","26.0206","26.0207","26.0208","26.0209","26.0210","26.0299","26.0300","26.0301","26.0305","26.0307","26.0308","26.0399","26.0400","26.0401","26.0403","26.0404","26.0406","26.0407","26.0499","26.0500","26.0502","26.0503","26.0504","26.0505","26.0506","26.0507","26.0508","26.0509","26.0599","26.0700","26.0701","26.0702","26.0707","26.0708","26.0709","26.0799","26.0800","26.0801","26.0802","26.0803","26.0804","26.0805","26.0806","26.0807","26.0899","26.0900","26.0901","26.0902","26.0903","26.0904","26.0905","26.0907","26.0908","26.0909","26.0910","26.0911","26.0912","26.0913","26.0999","26.1000","26.1001","26.1002","26.1003","26.1004","26.1005","26.1006","26.1007","26.1099","26.1100","26.1101","26.1102","26.1103","26.1104","26.1199","26.1200","26.1201","26.1300","26.1301","26.1302","26.1303","26.1304","26.1305","26.1306","26.1307","26.1308","26.1309","26.1310","26.1311","26.1399","26.1400","26.1401","26.1500","26.1501","26.1502","26.1503","26.1504","26.1599","26.9900","26.9999","27.0000","27.0100","27.0101","27.0102","27.0103","27.0104","27.0105","27.0199","27.0300","27.0301","27.0303","27.0304","27.0305","27.0306","27.0399","27.0500","27.0501","27.0502","27.0503","27.0599","27.0600","27.0601","27.9900","27.9999","28.0501","28.0502","28.0505","29.0201","29.0202","29.0203","29.0204","29.0205","29.0206","29.0207","29.0299","29.0301","29.0302","29.0303","29.0304","29.0305","29.0306","29.0307","29.0399","29.0401","29.0402","29.0403","29.0404","29.0405","29.0406","29.0407","29.0408","29.0409","29.0499","29.9999","30.0101","30.0601","30.0801","30.1001","30.1701","30.1801","30.1901","30.2501","30.2701","30.3001","30.3101","30.3201","30.3301","30.3401","30.3501","30.3801","30.3901","30.4101","30.4301","30.4401","30.4801","30.4901","30.5001","30.7001","30.7101","30.7102","30.7103","30.7104","30.7199","40.0000","40.0100","40.0101","40.0200","40.0201","40.0202","40.0203","40.0299","40.0400","40.0401","40.0402","40.0403","40.0404","40.0499","40.0500","40.0501","40.0502","40.0503","40.0504","40.0506","40.0507","40.0508","40.0509","40.0510","40.0511","40.0512","40.0599","40.0600","40.0601","40.0602","40.0603","40.0604","40.0605","40.0606","40.0607","40.0699","40.0800","40.0801","40.0802","40.0804","40.0805","40.0806","40.0807","40.0808","40.0809","40.0810","40.0899","40.1000","40.1001","40.1002","40.1099","40.1100","40.1101","40.9900","40.9999","41.0000","41.0101","41.0204","41.0205","41.0299","41.0301","41.0303","41.0399","41.9999","42.2701","42.2702","42.2703","42.2704","42.2705","42.2706","42.2707","42.2708","42.2709","42.2710","42.2799","42.2804","43.0403","43.0406","43.0407","45.0102","45.0301","45.0501","45.0603","45.0702","49.0101","51.1002","51.1005","51.1401","51.2003","51.2004","51.2005","51.2006","51.2007","51.2009","51.2010","51.2202","51.2205","51.2706","52.1301")
stem_2020 <- c(stem_2020a,stem_2020b)

Stem2020PR <- filter(Query_STEM_2020, CIPCODE %in% stem_2020)

write.csv(Stem2020PR, file="C:\\Users\\francisco.pesante\\OneDrive - Instituto de Estadisticas de Puerto Rico\\Documents\\2024\\01-programas\\03-preguntas\\Stem2020PR.csv",row.names = F)
####################################################################
Query_STEM_2021 <- read_excel("C:\\Users\\francisco.pesante\\OneDrive - Instituto de Estadisticas de Puerto Rico\\Documents\\2024\\01-programas\\03-preguntas\\Query-STEM-2021.xlsx")

stem_2021a <-c("01.0308","01.0901","01.0902","01.0903","01.0904","01.0905","01.0906","01.0907","01.0999","01.1001","01.1002","01.1099","01.1101","01.1102","01.1103","01.1104","01.1105","01.1106","01.1199","01.1201","01.1202","01.1203","01.1299","01.8105","01.8106","01.8107","01.8108","01.8109","01.8110","01.8111","03.0101","03.0103","03.0104","03.0199","03.0204","03.0205","03.0210","03.0501","03.0502","03.0508","03.0509","03.0510","03.0601","04.0601","04.0902","09.0702","10.0304","11.0101","11.0102","11.0103","11.0104","11.0105","11.0199","11.0201","11.0202","11.0203","11.0299","11.0301","11.0401","11.0501","11.0701","11.0801","11.0802","11.0803","11.0804","11.0899","11.0901","11.0902","11.1001","11.1002","11.1003","11.1004","11.1005","11.1006","11.1099","13.0501","13.0601","13.0603","13.0608","14.0000","14.0100","14.0101","14.0102","14.0103","14.0200","14.0201","14.0202","14.0299","14.0300","14.0301","14.0400","14.0401","14.0500","14.0501","14.0600","14.0601","14.0700","14.0701","14.0702","14.0799","14.0800","14.0801","14.0802","14.0803","14.0804","14.0805","14.0899","14.0900","14.0901","14.0902","14.0903","14.0999","14.1000","14.1001","14.1003","14.1004","14.1099","14.1100","14.1101","14.1200","14.1201","14.1300","14.1301","14.1400","14.1401","14.1800","14.1801","14.1900","14.1901","14.2000","14.2001","14.2100","14.2101","14.2200","14.2201","14.2300","14.2301","14.2400","14.2401","14.2500","14.2501","14.2700","14.2701","14.2800","14.2801","14.3200","14.3201","14.3300","14.3301","14.3400","14.3401","14.3500","14.3501","14.3600","14.3601","14.3700","14.3701","14.3800","14.3801","14.3900","14.3901","14.4000","14.4001","14.4100","14.4101","14.4200","14.4201","14.4300","14.4301","14.4400","14.4401","14.4500","14.4501","14.4700","14.4701","14.4800","14.4801","14.4802","14.4899","14.9900","14.9999")
stem_2021b <-c("15.0000","15.0101","15.0201","15.0303","15.0304","15.0305","15.0306","15.0399","15.0401","15.0403","15.0404","15.0405","15.0406","15.0407","15.0499","15.0501","15.0506","15.0507","15.0508","15.0599","15.0607","15.0611","15.0612","15.0613","15.0614","15.0615","15.0616","15.0617","15.0699","15.0701","15.0702","15.0703","15.0704","15.0799","15.0801","15.0803","15.0805","15.0899","15.0901","15.0903","15.0999","15.1001","15.1102","15.1103","15.1199","15.1201","15.1202","15.1203","15.1204","15.1299","15.1301","15.1302","15.1303","15.1304","15.1305","15.1306","15.1399","15.1401","15.1501","15.1502","15.1503","15.1599","15.1601","15.1701","15.1703","15.9999","26.0000","26.0100","26.0101","26.0102","26.0200","26.0202","26.0203","26.0204","26.0205","26.0206","26.0207","26.0208","26.0209","26.0210","26.0299","26.0300","26.0301","26.0305","26.0307","26.0308","26.0399","26.0400","26.0401","26.0403","26.0404","26.0406","26.0407","26.0499","26.0500","26.0502","26.0503","26.0504","26.0505","26.0506","26.0507","26.0508","26.0509","26.0599","26.0700","26.0701","26.0702","26.0707","26.0708","26.0709","26.0799","26.0800","26.0801","26.0802","26.0803","26.0804","26.0805","26.0806","26.0807","26.0899","26.0900","26.0901","26.0902","26.0903","26.0904","26.0905","26.0907","26.0908","26.0909","26.0910","26.0911","26.0912","26.0913","26.0999","26.1000","26.1001","26.1002","26.1003","26.1004","26.1005","26.1006","26.1007","26.1099","26.1100","26.1101","26.1102","26.1103","26.1104","26.1199","26.1200","26.1201","26.1300","26.1301","26.1302","26.1303","26.1304","26.1305","26.1306","26.1307","26.1308","26.1309","26.1310","26.1311","26.1399","26.1400","26.1401","26.1500","26.1501","26.1502","26.1503","26.1504","26.1599","26.9900","26.9999","27.0000","27.0100","27.0101","27.0102","27.0103","27.0104","27.0105","27.0199","27.0300","27.0301","27.0303","27.0304","27.0305","27.0306","27.0399","27.0500","27.0501","27.0502","27.0503","27.0599","27.0600","27.0601","27.9900","27.9999","28.0501","28.0502","28.0505","29.0201","29.0202","29.0203","29.0204","29.0205","29.0206","29.0207","29.0299","29.0301","29.0302","29.0303","29.0304","29.0305","29.0306","29.0307","29.0399","29.0401","29.0402","29.0403","29.0404","29.0405","29.0406","29.0407","29.0408","29.0409","29.0499","29.9999","30.0101","30.0601","30.0801","30.1001","30.1701","30.1801","30.1901","30.2501","30.2701","30.3001","30.3101","30.3201","30.3301","30.3401","30.3501","30.3801","30.3901","30.4101","30.4301","30.4401","30.4801","30.4901","30.5001","30.7001","30.7101","30.7102","30.7103","30.7104","30.7199","40.0000","40.0100","40.0101","40.0200","40.0201","40.0202","40.0203","40.0299","40.0400","40.0401","40.0402","40.0403","40.0404","40.0499","40.0500","40.0501","40.0502","40.0503","40.0504","40.0506","40.0507","40.0508","40.0509","40.0510","40.0511","40.0512","40.0599","40.0600","40.0601","40.0602","40.0603","40.0604","40.0605","40.0606","40.0607","40.0699","40.0800","40.0801","40.0802","40.0804","40.0805","40.0806","40.0807","40.0808","40.0809","40.0810","40.0899","40.1000","40.1001","40.1002","40.1099","40.1100","40.1101","40.9900","40.9999","41.0000","41.0101","41.0204","41.0205","41.0299","41.0301","41.0303","41.0399","41.9999","42.2701","42.2702","42.2703","42.2704","42.2705","42.2706","42.2707","42.2708","42.2709","42.2710","42.2799","42.2804","43.0403","43.0406","43.0407","45.0102","45.0301","45.0501","45.0603","45.0702","49.0101","51.1002","51.1005","51.1401","51.2003","51.2004","51.2005","51.2006","51.2007","51.2009","51.2010","51.2202","51.2205","51.2706","52.1301")
stem_2021 <- c(stem_2021a,stem_2021b)

Stem2021PR <- filter(Query_STEM_2021, CIPCODE %in% stem_2021)

write.csv(Stem2021PR, file="C:\\Users\\francisco.pesante\\OneDrive - Instituto de Estadisticas de Puerto Rico\\Documents\\2024\\01-programas\\03-preguntas\\Stem2021PR.csv",row.names = F)
####################################################################
# Fuente de sectores stem: https://www.dhs.gov/hsi/news/2024/07/22/dhs-announces-updated-dhs-stem-designated-degree-program-list > https://studyinthestates.dhs.gov/2024/07/review-the-updated-dhs-stem-designated-degree-program-list > https://www.ice.gov/doclib/sevis/pdf/stemList2024.pdf
# Reference:https://stackoverflow.com/questions/35845903/dplyr-filter-value-is-contained-in-a-vector
